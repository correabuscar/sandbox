mixture of abort()s and exit()s
